<div class="form-container">
  <div class="form-card">
    <header class="form-header">
      <h1>{{ isEditMode ? 'Edit Todo' : 'Create New Todo' }}</h1>
    </header>

    <div *ngIf="errorMessage" class="error-message" role="alert">
      {{ errorMessage }}
    </div>

    <form [formGroup]="todoForm" (ngSubmit)="onSubmit()" class="todo-form">
      <div class="form-group">
        <label for="title" class="form-label">
          Title <span class="required">*</span>
        </label>
        <input
          type="text"
          id="title"
          formControlName="title"
          class="form-input"
          [class.invalid]="isFieldInvalid('title')"
          placeholder="Enter todo title"
          aria-describedby="title-error"
        />
        <div *ngIf="isFieldInvalid('title')" class="error-text" id="title-error">
          <span *ngIf="hasError('title', 'required')">Title is required</span>
          <span *ngIf="hasError('title', 'minlength')">Title must be at least 3 characters</span>
          <span *ngIf="hasError('title', 'maxlength')">Title cannot exceed 100 characters</span>
        </div>
      </div>

      <div class="form-group">
        <label for="description" class="form-label">
          Description <span class="required">*</span>
        </label>
        <textarea
          id="description"
          formControlName="description"
          class="form-textarea"
          [class.invalid]="isFieldInvalid('description')"
          placeholder="Enter todo description"
          rows="5"
          aria-describedby="description-error"
        ></textarea>
        <div *ngIf="isFieldInvalid('description')" class="error-text" id="description-error">
          <span *ngIf="hasError('description', 'required')">Description is required</span>
          <span *ngIf="hasError('description', 'minlength')">Description must be at least 5 characters</span>
          <span *ngIf="hasError('description', 'maxlength')">Description cannot exceed 500 characters</span>
        </div>
      </div>

      <div class="form-group">
        <label for="dueDate" class="form-label">
          Due Date <span class="required">*</span>
        </label>
        <input
          type="date"
          id="dueDate"
          formControlName="dueDate"
          class="form-input"
          [class.invalid]="isFieldInvalid('dueDate')"
          aria-describedby="dueDate-error"
        />
        <div *ngIf="isFieldInvalid('dueDate')" class="error-text" id="dueDate-error">
          <span *ngIf="hasError('dueDate', 'required')">Due date is required</span>
        </div>
      </div>

      <div class="form-group checkbox-group">
        <label class="checkbox-label">
          <input
            type="checkbox"
            formControlName="completed"
            class="form-checkbox"
          />
          <span>Mark as completed</span>
        </label>
      </div>

      <div class="form-actions">
        <button
          type="button"
          (click)="onCancel()"
          class="btn btn-secondary"
          [disabled]="isSubmitting"
        >
          Cancel
        </button>
        <button
          type="submit"
          class="btn btn-primary"
          [disabled]="isSubmitting || todoForm.invalid"
        >
          <span *ngIf="!isSubmitting">{{ isEditMode ? 'Update' : 'Create' }} Todo</span>
          <span *ngIf="isSubmitting">Saving...</span>
        </button>
      </div>
    </form>
  </div>
</div>
